# 📊 АКТУАЛЬНАЯ ИНФОРМАЦИЯ О МОДЕЛЯХ ПРОЕКТА

**Дата обновления:** 11 февраля 2026  
**Проект:** kpd-zhzl-serverv  
**Версия API:** 2.0

---

## 🗂️ СТРУКТУРА МОДЕЛЕЙ

### У вас **12 моделей** в проекте:

#### 6 основных моделей (хранят данные):

1. **Street 📍** — улицы Петроградского района
   - Записей: **3**
   - Поля: `id`, `name`
   - Примеры: 
     - Каменноостровский проспект
     - Мичуринская улица
     - Кронверкский проспект

2. **Profession 👔** — профессии персон
   - Записей: **3+**
   - Поля: `id`, `name`
   - Примеры:
     - Литературовед
     - Писатель
     - Публицист

3. **Book 📚** — книги-источники
   - Записей: **3+**
   - Поля: `id`, `author`, `title`, `url`, `image`
   - Описание: Литературные источники и книги о персонах/событиях

4. **Keyword 🏷️** — теги для классификации
   - Записей: **2+**
   - Поля: `id`, `keyword`
   - Примеры:
     - литература
     - мемориальная доска

5. **Event 📅** — исторические события
   - Записей: **195**
   - Поля: `id`, `title`, `date`, `day`, `month`, `description_html`, `image`, `street`
   - **Новые поля (v2.0):** `day`, `month` — вычисляемые из `date`
   - Описание: События, произошедшие в Петроградском районе

6. **Person 👤** — биографии персон
   - Записей: **208**
   - Поля: `id`, `last_name`, `first_name`, `middle_name`, `full_name`, `short_name`, `birth_date`, `death_date`, `description_html`, `article_html`, `image`
   - **Новые поля (v2.0):** `full_name`, `short_name` — вычисляемые из ФИО
   - Описание: Выдающиеся личности Петроградского района

---

#### 7 промежуточных моделей (связывают основные):

1. **Person_event** — связь Персона ↔ Событие
   - Поля: `id`, `person`, `event`
   - Описание: Какие персоны участвовали в каких событиях

2. **Person_keyword** — связь Персона ↔ Тег
   - Поля: `id`, `person`, `keyword`
   - Описание: Тематическая классификация персон

3. **Event_keyword** — связь Событие ↔ Тег
   - Поля: `id`, `event`, `keyword`
   - Описание: Тематическая классификация событий

4. **Person_book** — связь Персона ↔ Книга
   - Поля: `id`, `person`, `book`
   - Описание: В каких книгах описаны персоны

5. **Event_book** — связь Событие ↔ Книга
   - Поля: `id`, `event`, `book`
   - Описание: В каких книгах описаны события

6. **Person_profession** — связь Персона ↔ Профессия
   - Поля: `id`, `person`, `profession`
   - Описание: Профессии каждой персоны

7. **Person_street** — связь Персона ↔ Улица
   - Поля: `id`, `person`, `street`
   - Описание: Улицы, связанные с персоной (жила, работала, училась)

---

## 🎯 ЧТО ОНИ ДЕЛАЮТ

### **Event (Событие)** — главная модель

**Что хранит:**
- ✅ Название события
- ✅ Дату события (полная дата)
- ✅ **День месяца** (новое в v2.0 — вычисляемое поле)
- ✅ **Номер месяца** (новое в v2.0 — вычисляемое поле)
- ✅ Описание в HTML формате
- ✅ Фотографию события

**Связи с другими моделями:**
- 🔗 **Street** (где произошло событие) — ForeignKey
- 🔗 **Person** (кто участвовал) — Many-to-Many через Person_event
- 🔗 **Book** (где описано) — Many-to-Many через Event_book
- 🔗 **Keyword** (тематика) — Many-to-Many через Event_keyword

**Примеры событий:**
- "Открыта мемориальная доска А. М. Гранову" (2020-10-29)
- "Открыта мемориальная доска П.С. Попкову" (1983-01-01)
- "Заложена Петропавловская крепость" (1703-05-27)

**API endpoints:**
- `GET /api/v1/event/` — список событий
- `GET /api/v1/event/{id}/` — детали события

---

### **Person (Персона)** — главная модель

**Что хранит:**
- ✅ Фамилия, Имя, Отчество
- ✅ **Полное ФИО** (новое в v2.0 — вычисляемое поле)
- ✅ **Фамилия И.О.** (новое в v2.0 — вычисляемое поле)
- ✅ Даты жизни (рождение/смерть)
- ✅ Краткое описание
- ✅ Развернутую биографию (статья)
- ✅ Фотографию

**Связи с другими моделями:**
- 🔗 **Event** (в каких событиях участвовала) — Many-to-Many через Person_event
- 🔗 **Profession** (профессии) — Many-to-Many через Person_profession
- 🔗 **Street** (где жила/работала) — Many-to-Many через Person_street
- 🔗 **Book** (где описана) — Many-to-Many через Person_book
- 🔗 **Keyword** (тематика) — Many-to-Many через Person_keyword

**Примеры персон:**
- Абрамов Фёдор Александрович (1920-02-29 – 1983-05-14)
- Агнивцев Николай Яковлевич (1888-04-20 – 1932-10-29)
- Алфёров Жорес Иванович (1930-03-15 – 2019-03-01)

**API endpoints:**
- `GET /api/v1/person/` — список персон
- `GET /api/v1/person/{id}/` — детали персоны

---

### **Остальные модели — справочники**

#### Street (Улицы)
**Назначение:** Справочник улиц Петроградского района  
**Использование:** Связь с Event (где произошло) и Person (где жила)  
**Записей:** 3

#### Profession (Профессии)
**Назначение:** Справочник профессий  
**Использование:** Связь с Person (профессии персон)  
**Записей:** 3+  
**Примеры:** Писатель, Литературовед, Публицист

#### Book (Книги)
**Назначение:** Справочник литературных источников  
**Использование:** Связь с Event и Person (где описаны)  
**Записей:** 3+

#### Keyword (Теги)
**Назначение:** Тематическая классификация  
**Использование:** Связь с Event и Person (тематика)  
**Записей:** 2+  
**Примеры:** литература, мемориальная доска

---

## 📊 СТАТИСТИКА БАЗЫ ДАННЫХ

```
┌─────────────────────────────┬────────────┬──────────┐
│ Модель                      │ Тип        │ Записей  │
├─────────────────────────────┼────────────┼──────────┤
│ Event                       │ Основная   │ 195      │
│ Person                      │ Основная   │ 208      │
│ Street                      │ Справочник │ 3        │
│ Profession                  │ Справочник │ 3+       │
│ Book                        │ Справочник │ 3+       │
│ Keyword                     │ Справочник │ 2+       │
├─────────────────────────────┼────────────┼──────────┤
│ Person_event                │ Связь M:N  │ —        │
│ Person_keyword              │ Связь M:N  │ —        │
│ Event_keyword               │ Связь M:N  │ —        │
│ Person_book                 │ Связь M:N  │ —        │
│ Event_book                  │ Связь M:N  │ —        │
│ Person_profession           │ Связь M:N  │ —        │
│ Person_street               │ Связь M:N  │ —        │
└─────────────────────────────┴────────────┴──────────┘
```

---

## 🆕 НОВЫЕ ПОЛЯ В ВЕРСИИ 2.0

### Event
- ✅ **day** (integer) — день месяца (1-31), вычисляется из `date`
- ✅ **month** (integer) — номер месяца (1-12), вычисляется из `date`

**Использование:**
```typescript
// До версии 2.0
const month = new Date(event.date).getMonth() + 1

// После версии 2.0
const month = event.month  // Готовое значение!
```

---

### Person
- ✅ **full_name** (string) — полное ФИО, вычисляется из last_name + first_name + middle_name
- ✅ **short_name** (string) — фамилия с инициалами, вычисляется автоматически

**Использование:**
```typescript
// До версии 2.0
const fullName = `${person.last_name} ${person.first_name} ${person.middle_name}`

// После версии 2.0
const fullName = person.full_name  // "Абрамов Фёдор Александрович"
const shortName = person.short_name  // "Абрамов Ф.А."
```

---

## 🔗 СХЕМА СВЯЗЕЙ

```
           ┌──────────┐
           │  Event   │
           │  (195)   │
           └────┬─────┘
                │
      ┌─────────┼─────────┬─────────┐
      │         │         │         │
      ▼         ▼         ▼         ▼
  ┌──────┐ ┌────────┐ ┌──────┐ ┌─────────┐
  │Street│ │ Person │ │ Book │ │ Keyword │
  │  (3) │ │ (208)  │ │ (3+) │ │  (2+)   │
  └──────┘ └───┬────┘ └──────┘ └─────────┘
               │
      ┌────────┼────────┐
      │        │        │
      ▼        ▼        ▼
  ┌──────────┐ ┌──────┐ ┌─────────┐
  │Profession│ │Street│ │ Keyword │
  │   (3+)   │ │ (3)  │ │  (2+)   │
  └──────────┘ └──────┘ └─────────┘
```

**Связи:**
- Event → Street (ForeignKey)
- Event ↔ Person (Many-to-Many)
- Event ↔ Book (Many-to-Many)
- Event ↔ Keyword (Many-to-Many)
- Person ↔ Profession (Many-to-Many)
- Person ↔ Street (Many-to-Many)
- Person ↔ Book (Many-to-Many)
- Person ↔ Keyword (Many-to-Many)

---

## 🎯 ПРАКТИЧЕСКОЕ ИСПОЛЬЗОВАНИЕ

### Пример 1: Получить все события с персонами
```python
event = Event.objects.get(id=394)
persons = event.persons.all()  # Все персоны события

for person in persons:
    print(person.full_name)  # Используем новое поле!
```

### Пример 2: Получить все события персоны
```python
person = Person.objects.get(id=210)
events = person.events.all()  # Все события персоны

for event in events:
    print(f"{event.title} ({event.day}.{event.month})")  # Используем новые поля!
```

### Пример 3: Фильтр событий по месяцу
```python
# API запрос
GET /api/v1/event/?date__month=10

# Результат: все события октября
# Теперь у каждого события есть готовое поле month=10
```

---

## ✅ ИТОГО

**Всего моделей:** 12  
**Основных:** 6 (Event, Person, Street, Profession, Book, Keyword)  
**Промежуточных:** 7 (связи Many-to-Many)  
**Всего записей:** 403+ (195 событий + 208 персон)  
**Новых полей:** 4 (day, month, full_name, short_name)  
**API endpoints:** 24  
**Статус:** ✅ Готово к продакшену
